<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>Curiosity is bliss: "MSDN Language Filter" user script</title>

<link rel="stylesheet" href="http://blog.monstuff.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.monstuff.com/index.rdf" />

<link rel="start" href="http://blog.monstuff.com/" title="Home" />

<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', '{{ site.ga }}', 'auto');
    ga('send', 'pageview');
</script>

</head>

<body>

<div id="banner">
<h1><a href="http://blog.monstuff.com/" accesskey="1">Curiosity is bliss</a></h1>
<span class="description">Julien Couvreur's programming blog and more</span>
</div>

<div id="container">


<div class="blog">




<div class="blogbody">

<h2 class="title">"MSDN Language Filter" user script</h2>

<p>Just finished my <a title="right click &#8594; Install User Script..." href="http://blog.monstuff.com/archives/images/MSDNLanguageFilter.user.js">MSDN Language Filter</a> Greasemonkey user script. It removes the code samples for the languages you don't care about (say VB or JScript), on MSDN. <br />
It lets you choose which language you want to filter out (see screenshot below) and remembers your preferences (using the new <a href="http://www.mozdev.org/pipermail/greasemonkey/2005-April/000999.html">GreaseMonkey 0.3 data persistence APIs</a>).</p>

<p>Here's a <a href="http://blog.monstuff.com/archives/images/MSDNLanguageFilterScreenshot.jpg">screenshot</a>.</p>

<a name="more"></a>
<p> <br />
<u>Update (2006-01-30):</u> Updated the script to run in Greasmonkey 0.6.4 and Firefox 1.5. <br />
Also included <a href="http://www.sharepointblogs.com/benc/default.aspx">Ben Cartwright</a>'s fix for the SharePoint SDK (see comments below). Thanks Ben!</p>

<span class="posted">Posted by Julien on April 12, 2005. <a href="http://blog.monstuff.com/archives/000240.html" rel="bookmark">Permalink</a> 
<br /></span>

</div>



<div class="comments-head"><a name="comments"></a>Comments</div>

<div class="comments-body">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'curiosityisbliss'; 
        var disqus_identifier = '240';
        var disqus_url = 'http://blog.monstuff.com/archives/000240.html';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>    




<div class="comments-body">
<p>Hi Julien - Just installed this script and I'm not having much luck with it unfortunately. When I click on the language filter link, it just makes the bottom two frames completely disappear. For example when I go to the String class page:<br />
<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemStringClassTopic.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemStringClassTopic.asp</a></p>

<p>I click the C# link, and for some reason it redirects me to:<br />
<a href="http://msdn.microsoft.com/library/shared/deeptree/asp/toolbar.asp?tbcfg=/library/toolbarconfig.xml#">http://msdn.microsoft.com/library/shared/deeptree/asp/toolbar.asp?tbcfg=/library/toolbarconfig.xml#</a></p>

<p>Hmmm, any idea why this would be happening?</p>

<p>Cheers<br />
Nick</p>
<span class="comments-post">Posted by: <a href="mailto&#58;nick&#64;headsphere&#46;net">Nick Head</a> at April 23, 2005 09:28 PM</span>
</div>
<div class="comments-body">
<p>Hey Nick,</p>

<p>Couldn't repro the problem so far.<br />
Do you see any javascript errors from this script when you open a MSDN<br />
reference page?<br />
If not, what platform (Firefox version, GM version and OS) are you using?</p>

<p>Thanks,</p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com/">Julien Couvreur</a> at April 26, 2005 03:44 PM</span>
</div>
<div class="comments-body">
<p>Hi Julien</p>

<p>My version no's are:<br />
FF 1.0.3<br />
GM 0.2.6<br />
XP SP2</p>

<p>I just checked the JS console and I found this error message popped up about<br />
10 times:</p>

<p>Error: GM_setValue is not defined<br />
Source File:<br />
<a href="http://msdn.microsoft.com/library/shared/deeptree/asp/toolbar.asp?tbcfg=/lib">http://msdn.microsoft.com/library/shared/deeptree/asp/toolbar.asp?tbcfg=/lib</a><br />
rary/toolbarconfig.xml<br />
Line: 100</p>

<p>Very weird - does that mean that GM_setValue doesn't exist in GM 0.2.6?</p>

<p>...I just investigated it and apparently GM_setValue isn't in the last<br />
stable release 0.2.6, you need to upgrade to 0.3b. Installed latest version<br />
and..... Ha haaaa - It works! :)</p>

<p>Thanks for your help<br />
Nick</p>
<span class="comments-post">Posted by: <a href="mailto&#58;nick&#64;headsphere&#46;net">Nick Head</a> at April 26, 2005 03:46 PM</span>
</div>
<div class="comments-body">
<p>Cool. I just fixed the script so that it alerts if you run it on an older version of GM.</p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com">Julien</a> at April 26, 2005 03:47 PM</span>
</div>
<div class="comments-body">
<p>Nice user script, Julien.  Thanks for sharing it!</p>

<p>For some reason, though, the SharePoint SDK on MSDN uses a different set of tags for its code samples that the xpath "//span[@class = 'lang']" won't match.</p>

<p>Example page from the SDK: <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/spptsdk/html/tscSPWeb_SV01013607.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/spptsdk/html/tscSPWeb_SV01013607.asp</a></p>

<p>Here's a quick patch to your script that I came up with to handle this oddball case:</p>

<p>// In the FilterLanguages function, change:<br />
var xpath = "//span[@class = 'lang']";</p>

<p>// To:<br />
var xpath = "//span[@class = 'lang'] | //pre[@class = 'signature']/p";</p>

<p>// Then, at the end of the function, change:<br />
if (!keepLang)<br />
{<br />
    this.CleanSpan(res.snapshotItem(i), res.snapshotItem(i+1));<br />
}</p>

<p>// To:<br />
if (!keepLang)<br />
{<br />
    if (spanElement.tagName == 'P')<br />
    {<br />
        var pre = res.snapshotItem(i).parentNode;<br />
        pre.parentNode.removeChild(pre);<br />
    }<br />
    else<br />
    {<br />
        this.CleanSpan(res.snapshotItem(i), res.snapshotItem(i+1));<br />
    }<br />
}<br />
</p>
<span class="comments-post">Posted by: <a href="http://www.sharepointblogs.com/benc/default.aspx">Ben Cartwright</a> at November 10, 2005 08:37 PM</span>
</div>



</div>
</div>


</body>
</html>