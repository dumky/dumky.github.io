<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>Curiosity is bliss: "MSDN Language Filter" user script</title>

<link rel="stylesheet" href="http://blog.monstuff.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.monstuff.com/index.rdf" />

<link rel="start" href="http://blog.monstuff.com/" title="Home" />
<link rel="prev" href="http://blog.monstuff.com/archives/000239.html" title="Various Greasemonkey user scripts" />

<link rel="next" href="http://blog.monstuff.com/archives/000243.html" title="Closures &amp; Continuations" />



<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-74363-1";
urchinTracker();
</script>

<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'blog.monstuff.com';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>



<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="http://blog.monstuff.com/archives/000240.html">
<dc:title>&quot;MSDN Language Filter&quot; user script</dc:title>
<dc:description>Just finished my MSDN Language Filter Greasemonkey user script. It removes the code samples for the languages you don&apos;t care about (say VB or JScript), on MSDN. It lets you choose which language you want to filter out (see screenshot below) and remembers your preferences (using the new GreaseMonkey 0.3 data persistence APIs). Here&apos;s a screenshot....</dc:description>
<dc:creator>Julien</dc:creator>
<dc:date>2005-04-12T14:54:45-08:00</dc:date>
<license rdf:resource="http://creativecommons.org/licenses/by-sa/1.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-sa/1.0/">
<requires rdf:resource="http://web.resource.org/cc/Attribution" />
<requires rdf:resource="http://web.resource.org/cc/Notice" />
<requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
<permits rdf:resource="http://web.resource.org/cc/Reproduction" />
<permits rdf:resource="http://web.resource.org/cc/Distribution" />
<permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
</License>
</rdf:RDF>
-->



</head>

<body>

<div id="banner">
<h1><a href="http://blog.monstuff.com/" accesskey="1">Curiosity is bliss</a></h1>
<span class="description">Julien Couvreur's programming blog and more</span>
</div>

<div id="container">

<div class="blog">







<div id="menu">
<a href="http://blog.monstuff.com/archives/000239.html">« Various Greasemonkey user scripts</a>&nbsp;&nbsp; 

| &nbsp;&nbsp;<a href="/archives.html">Archive list</a>&nbsp;&nbsp;
| &nbsp;&nbsp;<a href="http://blog.monstuff.com/archives/000380.html">Thick displays</a> (latest)

</div>

</div>

<div class="blog">

<!-- <h2 class="date">April 12, 2005</h2> -->




<div class="blogbody">
<!-- google_ad_section_start -->

<h2 class="title">"MSDN Language Filter" user script</h2>

<p>Just finished my <a title="right click &#8594; Install User Script..." href="http://blog.monstuff.com/archives/images/MSDNLanguageFilter.user.js">MSDN Language Filter</a> Greasemonkey user script. It removes the code samples for the languages you don't care about (say VB or JScript), on MSDN. <br />
It lets you choose which language you want to filter out (see screenshot below) and remembers your preferences (using the new <a href="http://www.mozdev.org/pipermail/greasemonkey/2005-April/000999.html">GreaseMonkey 0.3 data persistence APIs</a>).</p>

<p>Here's a <a href="http://blog.monstuff.com/archives/images/MSDNLanguageFilterScreenshot.jpg">screenshot</a>.</p>

<a name="more"></a>
<p> <br />
<u>Update (2006-01-30):</u> Updated the script to run in Greasmonkey 0.6.4 and Firefox 1.5. <br />
Also included <a href="http://www.sharepointblogs.com/benc/default.aspx">Ben Cartwright</a>'s fix for the SharePoint SDK (see comments below). Thanks Ben!</p>

<span class="posted">Posted by Julien on April 12, 2005. <a href="http://blog.monstuff.com/archives/000240.html" rel="bookmark">Permalink</a> <!-- -->
<br /></span>

</div>



<div class="comments-head"><a name="comments"></a>Comments</div>

<div class="comments-body">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'curiosityisbliss'; 
        var disqus_identifier = '240';
        var disqus_url = 'http://blog.monstuff.com/archives/000240.html';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>    





<div class="comments-body">
<p>Hi Julien - Just installed this script and I'm not having much luck with it unfortunately. When I click on the language filter link, it just makes the bottom two frames completely disappear. For example when I go to the String class page:<br />
<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemStringClassTopic.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemStringClassTopic.asp</a></p>

<p>I click the C# link, and for some reason it redirects me to:<br />
<a href="http://msdn.microsoft.com/library/shared/deeptree/asp/toolbar.asp?tbcfg=/library/toolbarconfig.xml#">http://msdn.microsoft.com/library/shared/deeptree/asp/toolbar.asp?tbcfg=/library/toolbarconfig.xml#</a></p>

<p>Hmmm, any idea why this would be happening?</p>

<p>Cheers<br />
Nick</p>
<span class="comments-post">Posted by: <a href="mailto&#58;nick&#64;headsphere&#46;net">Nick Head</a> at April 23, 2005 09:28 PM</span>
</div>
<div class="comments-body">
<p>Hey Nick,</p>

<p>Couldn't repro the problem so far.<br />
Do you see any javascript errors from this script when you open a MSDN<br />
reference page?<br />
If not, what platform (Firefox version, GM version and OS) are you using?</p>

<p>Thanks,</p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com/">Julien Couvreur</a> at April 26, 2005 03:44 PM</span>
</div>
<div class="comments-body">
<p>Hi Julien</p>

<p>My version no's are:<br />
FF 1.0.3<br />
GM 0.2.6<br />
XP SP2</p>

<p>I just checked the JS console and I found this error message popped up about<br />
10 times:</p>

<p>Error: GM_setValue is not defined<br />
Source File:<br />
<a href="http://msdn.microsoft.com/library/shared/deeptree/asp/toolbar.asp?tbcfg=/lib">http://msdn.microsoft.com/library/shared/deeptree/asp/toolbar.asp?tbcfg=/lib</a><br />
rary/toolbarconfig.xml<br />
Line: 100</p>

<p>Very weird - does that mean that GM_setValue doesn't exist in GM 0.2.6?</p>

<p>...I just investigated it and apparently GM_setValue isn't in the last<br />
stable release 0.2.6, you need to upgrade to 0.3b. Installed latest version<br />
and..... Ha haaaa - It works! :)</p>

<p>Thanks for your help<br />
Nick</p>
<span class="comments-post">Posted by: <a href="mailto&#58;nick&#64;headsphere&#46;net">Nick Head</a> at April 26, 2005 03:46 PM</span>
</div>
<div class="comments-body">
<p>Cool. I just fixed the script so that it alerts if you run it on an older version of GM.</p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com">Julien</a> at April 26, 2005 03:47 PM</span>
</div>
<div class="comments-body">
<p>Nice user script, Julien.  Thanks for sharing it!</p>

<p>For some reason, though, the SharePoint SDK on MSDN uses a different set of tags for its code samples that the xpath "//span[@class = 'lang']" won't match.</p>

<p>Example page from the SDK: <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/spptsdk/html/tscSPWeb_SV01013607.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/spptsdk/html/tscSPWeb_SV01013607.asp</a></p>

<p>Here's a quick patch to your script that I came up with to handle this oddball case:</p>

<p>// In the FilterLanguages function, change:<br />
var xpath = "//span[@class = 'lang']";</p>

<p>// To:<br />
var xpath = "//span[@class = 'lang'] | //pre[@class = 'signature']/p";</p>

<p>// Then, at the end of the function, change:<br />
if (!keepLang)<br />
{<br />
    this.CleanSpan(res.snapshotItem(i), res.snapshotItem(i+1));<br />
}</p>

<p>// To:<br />
if (!keepLang)<br />
{<br />
    if (spanElement.tagName == 'P')<br />
    {<br />
        var pre = res.snapshotItem(i).parentNode;<br />
        pre.parentNode.removeChild(pre);<br />
    }<br />
    else<br />
    {<br />
        this.CleanSpan(res.snapshotItem(i), res.snapshotItem(i+1));<br />
    }<br />
}<br />
</p>
<span class="comments-post">Posted by: <a href="http://www.sharepointblogs.com/benc/default.aspx">Ben Cartwright</a> at November 10, 2005 08:37 PM</span>
</div>



<div class="comments-head"><a name="trackbacks"></a>Trackbacks</div>

<div class="trackback-body">
<a name="282"></a>
<span class="trackback-post"><a href="http://weblogs.asp.net/kdente/archive/2005/06/01/410014.aspx" target="new">re: My first GreaseMonkey script - MSDN Product Feedback</a><br />
<b>Excerpt:</b> <br />
<b>Weblog:</b> Kevin Dente's PuppiesAndIceCreamBlog<br />
<b>Tracked:</b> June  1, 2005 02:53 PM</span>
</div>


<!-- google_ad_section_end -->

<div class="comments-body">
<!--
Comments are closed. You can <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#106;&#117;&#108;&#105;&#101;&#110;&#46;&#99;&#111;&#117;&#118;&#114;&#101;&#117;&#114;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">contact me by email</a>. 
-->
</div>


</div>
</div>

<!-- google_ad_section_start(weight=ignore) -->
<div id="links">

<div class="sidetitle">
Recent Entries
</div>

<div class="side">
<a href="/archives.html">All entries (270)</a><br />
<br />

<a href="http://blog.monstuff.com/archives/000380.html">Thick displays</a><br />
<a href="http://blog.monstuff.com/archives/000377.html">Hans Rosling on the facts about population</a><br />
<a href="http://blog.monstuff.com/archives/000376.html">Bill Nye and Ken Ham debating on creationism</a><br />
<a href="http://blog.monstuff.com/archives/000375.html">Prediction vs Explanation</a><br />
<a href="http://blog.monstuff.com/archives/000374.html">Protectionism == Luddism</a><br />
<a href="http://blog.monstuff.com/archives/000373.html">Moderated off Boing Boing</a><br />
<a href="http://blog.monstuff.com/archives/000372.html">I &#9829; Patent Trolls</a><br />
<a href="http://blog.monstuff.com/archives/000371.html">Head Mounted Displays</a><br />
<a href="http://blog.monstuff.com/archives/000370.html">Better async programming in .Net</a><br />
<a href="http://blog.monstuff.com/archives/000369.html">Action, preferences, value</a><br />
<a href="http://blog.monstuff.com/archives/000368.html">Fresh breeze on climate debate</a><br />
<a href="http://blog.monstuff.com/archives/000367.html">On-the-fly book scanning</a><br />
<a href="http://blog.monstuff.com/archives/000366.html">State and education</a><br />
<a href="http://blog.monstuff.com/archives/000365.html">Live Geometry screencast</a><br />
<a href="http://blog.monstuff.com/archives/000364.html">Wired Science TV show</a><br />
<a href="http://blog.monstuff.com/archives/000362.html">Expectations and accountability in Economics</a><br />
<a href="http://blog.monstuff.com/archives/000361.html">Science of human action</a><br />
<a href="http://blog.monstuff.com/archives/000359.html">Reactive programming in javascript and C#</a><br />
<a href="http://blog.monstuff.com/archives/000358.html">Google Wave</a><br />
<a href="http://blog.monstuff.com/archives/000357.html">Reading facial expressions</a><br />

</div>
<!-- google_ad_section_end -->

</body>
</html>
