<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>Curiosity is bliss: Reflection on web single sign-on</title>

<link rel="stylesheet" href="http://blog.monstuff.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.monstuff.com/index.rdf" />

<link rel="start" href="http://blog.monstuff.com/" title="Home" />
<link rel="prev" href="http://blog.monstuff.com/archives/000122.html" title="Blog on hold while moving" />

<link rel="next" href="http://blog.monstuff.com/archives/000132.html" title="Back online at last!" />


<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'blog.monstuff.com';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="http://blog.monstuff.com/archives/000123.html"
    trackback:ping="http://blog.monstuff.com/movabletype/mt-tb.cgi/80"
    dc:title="Reflection on web single sign-on"
    dc:identifier="http://blog.monstuff.com/archives/000123.html"
    dc:subject="Opinion"
    dc:description="Steven started a discussion about Passport and its licensing. I think it reveals some frustration in the web development world that there is no widely available single sign-on solution for developpers to use on their web site. I use a bunch of community sites, like slashdot, kuro5hin, shouldexist or gotmono, and register the same nickname on all of them and mostly the same passwords. But I still need to sign into them individually. Also, changing my password is really a pain. Registering your personal data or profile information is also a problem, but it is really difficult to handle in..."
    dc:creator="Julien"
    dc:date="2003-12-27T02:05:56-08:00" />
</rdf:RDF>
-->




</head>

<body>

<div id="banner">
<h1><a href="http://blog.monstuff.com/" accesskey="1">Curiosity is bliss</a></h1>
<span class="description">Julien Couvreur's programming blog and more</span>
</div>

<div id="container">

<div class="blog">







<div id="menu">
<a href="http://blog.monstuff.com/archives/000122.html">« Blog on hold while moving</a> |

<a href="http://blog.monstuff.com/">Main</a> 
| <a href="/archives.html">All entries (171)</a>
| <a href="http://blog.monstuff.com/archives/000132.html">Back online at last! »</a>

</div>

</div>

<div class="blog">

<h2 class="date">December 27, 2003</h2>



<div class="adsense" style="float:right;">
<script type="text/javascript"><!--
google_ad_client = "pub-0922423824950731";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_channel ="";
google_ad_type = "text";
google_color_border = "F6F6F6";
google_color_bg = "FFFFFF";
google_color_link = "666666";
google_color_url = "003366";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>



<div class="blogbody">

<h3 class="title">Reflection on web single sign-on</h3>

<p>Steven started <a href="http://weblogs.asp.net/ssmith/posts/10517.aspx">a discussion</a> about <a href="http://www.passport.net">Passport</a> and its licensing. I think it reveals some frustration in the web development world that there is no widely available single sign-on solution for developpers to use on their web site.</p>

<p>I use a bunch of community sites, like slashdot, kuro5hin, shouldexist or gotmono, and register the same nickname on all of them and mostly the same passwords. But I still need to sign into them individually. Also, changing my password is really a pain.<br />
Registering your personal data or profile information is also a problem, but it is really difficult to handle in a SSO system because of privacy and consent issues: which sites does you want to share each piece of information with?</p>

<a name="more"></a>
<p><b>Background</b><br />
<u>Kerberos</u><br />
Kerberos is one of the key protocols when it comes to authentication over the network. It is mostly centralized, but supports multiple authentication suppliers, via the concept of realms.<br />
The essence of the protocol and its justification are very well explained in <a href="http://web.mit.edu/kerberos/www/dialogue.html">"Designing an Authentication System: a Dialogue in Four Scenes"</a>.</p>

<p><u>Passport</u><br />
You can find information about Passport by downloading the sdk from <a href="http://www.microsoft.com/downloads/">MSDN</a> (search "passport sdk") and in this <a href="http://avirubin.com/passport.htm">description and threat model of Passport</a>.<br />
Passport uses a model similar to Kerberos, where the authentication system establishs trust relationships (by exchanging keys offline, with the trusted parties) then generates encrypted authentication tokens. The tokens are encrypted with keys only known to the authentication system and the participating websites, and they contain a proof that the user was authentified by the authentication system within a certain time.<br />
These tokens are implemented as cookies, so that they travel along with the requests to the participating website. The website accepts them for a limited time and then redirects the browser back to the authentication system for fresh cookies to be generated.</p>

<p>Passport has some limitations:<br />
- 10000$ licensing fee,<br />
- keys need to be distributed,<br />
- cookies can be stolen/copied/replayed until they become too old,<br />
- only one user can be logged at a given moment, you can't be logged in with Passport A at site X and Passport B at site Y,<br />
- even though the user profile may be shared with the participating website, there is no guarantee that the data actually is shared, since it depends on the user's consent,<br />
- tickets can expire in the middle of a multi-step process, which means that POST data may be lost because of a re-authentication,<br />
- it is centralized and Microsoft owned, you can't have multiple authentication systems (say Microsoft and AOL) collaborate to appear like one larger authentication system (authenticate users from both realms to participating websites in both realms),</p>

<p><br />
<u>SSO Security</u></p>

<p><br />
<b>What would a minimalistic SSO system look like?</b><br />
I think that a simplified Passport-like system could be a viable SSO solution for many community sites.<br />
In order to keep the system simple and robust, only two interfaces would be provided: a web interface and a SOAP interface. The SOAP interface should be designed to support the authenticated use of webservices.</p>

<p><u>User IDs</u><br />
As any SSO, some kind of identifier is needed. But as users can't possibly remember "0193BF00A6C31" as their username. Using both a large number and a username as identifiers makes it easy for the participating sites (the large number has a fixed length and no "weird" characters) and the username is easy for the user to remember. Both need to be unique within the SSO. Unlike in Passport, there is no reason for the username to be an email address: lots of users probably have multiple email addresses and have their main email address change every couple years (when changing job or ISP).</p>

<p><u>Registration data</u><br />
No superfluous data should be collected from the user. If a participating site needs the user's birthdate, it can collect the information directly from the user. Although this means that the user still has to duplicate some of the registration effort accross sites, it will help the SSO stay minimal.</p>

<p>In order to make updates of this personal information manageable, the SSO will record a date for the last profile change. The web authentication interface can then offer a "My personal information recently changed" checkbox, that will update the profile timestamp. This will trigger participating websites to offer you to update your account information, when you access their website, because they can detect that the profile timestamp has changed.<br />
The profile timestamp could also be a version number, instead of a date.</p>

<p>A personal email address would also be collected as part of the registration process, and would allow the user to regain access to his account by prooving he owns the email address, in case he forgets his password. This email address should only be used for account maintenance, but shouldn't be communicated to participating sites. Not collecting private information and not sharing the email address should avoid any privacy issues.<br />
Any participatant that needs an extra level of security, to protect money or anything of significant value, will need to either avoid this SSO system or implement its own additional authentication for the parts of the site that require it.</p>

<p><u>Authentication tickets</u><br />
Authentication tokens or tickets would only contain the unique user identifier along with timestamps. <br />
Unlike in the Kerberos dialog, the IP of the client can't be used in the ticket, because proxies and firewalls are common practice on the web.</p>

<p>Whether the ticket should contain the user's nickname is open for debate: <br />
- if it is shared, then changing it wouldn't be recommended, as your posts on forums would appear to have come from a different person,<br />
- if it isn't shared, then each forums has to let you pick a nickname, but then there is no guarantee you'll be able to get the same nickname accross participating sites.<br />
I think the first option is better, as most sites today don't allow you to change your nickname anyway.</p>

<p><u>Security</u><br />
As mentioned above, this sytem isn't designed to protect valuable resources, it offers only a basic authentication with reasonnable security.<br />
For example, you can get access to the account if you manage to intercept the emails sent when resetting the password. This could be improved a bit by allowing a user to disable this "authentication by email" feature for his account.<br />
This is also why I didn't discuss having SSL required either on the authentication system or the participating site. But using SSL to protect the connections to the authentication system that involve the user's password would be a reasonnable addition to the authentication system.</p>

<p><br />
Login options? force signin, time based freshness,... How can the partner implement a richer UX based on these login options?</p>

<p>Include the RU in the ticket. Have all incoming requests be signed by partner AND do RootURL check.</p>

<p>UX: use a popup instead of a redirect?</p>

<p><b>Further discussions</b><br />
How to finance the SSO?</p>

<p>Migration stragegies<br />
In:<br />
Conflicting nicknames<br />
Out:<br />
Internal user IDs should be included from the start.</p>

<p>Extra flexibility<br />
Multi-account<br />
Multi-realm: architecture? trust? nickname conflicts (namespaces are required)</p>

<p><br />
Federation: the network effect should help. Sites who join get some benefits and also benefit others automatically. The question is how to make this secure, easy to implement and easy to use?<br />
Users don't care about a separate identity system, the model used should be more like Visa.</p>

<p>http://weblog.infoworld.com/udell/2003/04/02.html#a654<br />
http://weblog.infoworld.com/udell/2003/02/02.html#a592</p>

<p>http://weblogs.asp.net/eporter/posts/35854.aspx</p>

<p>TypeKey<br />
http://www.typekey.com/faq/</p>

<p>SimpleID<br />
http://esigler.2nw.net/blog/2004/03/11/simpleid</p>

<p>Flickr<br />
http://www.flickr.com/services/</p>

<p><br />
</p>

<span class="posted">Posted by Julien. <a href="http://blog.monstuff.com/archives/000123.html">Permalink</a> | <a href="http://blog.monstuff.com/movabletype/mt-tb.cgi?__mode=view&amp;entry_id=123" onclick="OpenTrackback(this.href); return false">TrackBack</a>

<br /></span>

</div>







<div class="comments-head"><a name="comments"></a>Comments</div>




<div class="comments-head"><a name="trackbacks"></a>Trackbacks</div>




<div class="comments-head">Post a comment</div>

<div class="comments-body">
<form method="post" action="http://blog.monstuff.com/movabletype/mt-lessspam-comments.cgi" name="comments_form" onsubmit="if (this.bakecookie[0].checked) rememberMe(this)">
<input type="hidden" name="static" value="1" />
<input type="hidden" name="entry_id" value="123" />

<div style="width:180px; padding-right:15px; margin-right:15px; float:left; text-align:left; border-right:1px dotted #bbb;">
	<label for="author">Name:</label><br />
	<input tabindex="1" id="author" name="author" /><br /><br />

	<label for="email">Email Address:</label><br />
	<input tabindex="2" id="email" name="email" /><br /><br />

	<label for="url">URL:</label><br />
	<input tabindex="3" id="url" name="url" /><br /><br />
</div>


Your email address won't be published on the site if you also input a URL. <br />
<br />
Remember personal info?<br />
<input type="radio" id="bakecookie" name="bakecookie" /><label for="bakecookie">Yes</label><input type="radio" id="forget" name="bakecookie" onclick="forgetMe(this.form)" value="Forget Info" style="margin-left: 15px;" /><label for="forget">No</label><br style="clear: both;" />


<label for="text">Comments:</label><br />
<textarea tabindex="4" id="text" name="text" rows="10" cols="50"></textarea><br /><br />

<input type="submit" name="preview" value="&nbsp;Preview&nbsp;" />
<input style="font-weight: bold;" type="submit" name="post" value="&nbsp;Post&nbsp;" /><br /><br />

</form>

<script type="text/javascript" language="javascript">
<!--
document.comments_form.email.value = getCookie("mtcmtmail");
document.comments_form.author.value = getCookie("mtcmtauth");
document.comments_form.url.value = getCookie("mtcmthome");
if (getCookie("mtcmtauth")) {
    document.comments_form.bakecookie[0].checked = true;
} else {
    document.comments_form.bakecookie[1].checked = true;
}
//-->
</script>
</div>


</div>
</div>
</body>
</html>
