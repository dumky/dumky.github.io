---
title: Cross-Site Request Forgery and Capability-based Security
date: 2006-08-09 17:21:39 +0800
disqus_identifier: 301
disqus_url: http://blog.monstuff.com/archives/000301.html
---

<p>Chris Shiflett wrote a nice post on <a href="http://shiflett.org/archive/90">CSRF attacks</a>. These attacks are <a href="http://simon.incutio.com/archive/2005/05/06/bad#comment12">not new</a> but they remain common and <a href="http://4diggers.blogspot.com/2006/06/how-to-defeat-digg.html">digg.com was recently vulnerable to such an exploit</a> (which would make un-willing visitors digg a story, as long as they were logged into digg.com).</p>

<p>This post on the digg.com flaw refers to the CSRF technique as "session riding". It's the first time that I see this name, but it's quite descriptive and it highlights that the core of this problem lies with the choice of the security model (principal-based access control). <br />
In that security model, the authority to perform certain actions is implicit after the user is authenticated. But it's often too easy to trick the agent holding the credentials to misuse that implicit or ambient authority. </p>

<p>Using a formkey is just way to ensure that only a certain page has authority to POST to a certain url, which is very much in line with capability-based security. <br />
If the capability approach and way of thinking were to become more pervasive, I believe that the web would become safer while allowing more collaboration and integration between sites. Also, using capabilities pretty much avoids the (hard) problem of building a global and distributed identity system.</p>

<p>I encourage you to check out the presentation by an HP research team on Google Video on topic of capabilities and authority-based access control for the web, <a href="http://video.google.com/videoplay?docid=8799856896828158583">Core Patterns for Web Permissions</a>, by Tyler Close.</p>
<p>It's actually part of a whole series (4 parts), but Tyler's talk is focused on applying the concepts to the web. <br />
The other episodes are about applying the concepts at different scopes: to the system, the programming language and the user interface:<br />
<ul><li>Alan Karp introduces <a href="http://video.google.com/videoplay?docid=-7179100659758053865">"The Virus Safe Computing Initiative at HP Labs"</a>, </li><li>Mark Miller goes deeper with: <a href="http://video.google.com/videoplay?docid=-8527120258517176598">"Paradigm Regained: Abstraction Mechanisms for Access Control"</a>, </li><li>Tyler Close looks at the web in: <a href="http://video.google.com/videoplay?docid=8799856896828158583">"Core Patterns for Web Permissions"</a>, </li><li>Marc Stiegler closes the serie with his very convincing talk on applying capability-based security to the desktop and the browser: <a href="http://video.google.com/videoplay?docid=-7961423532989255419">"From Desktops to Donuts: Object-Caps Across Scales"</a>. </li></ul></p>

______________________________________




