<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>Curiosity is bliss: Minimalistic C# media player</title>

<link rel="stylesheet" href="http://blog.monstuff.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.monstuff.com/index.rdf" />

<link rel="start" href="http://blog.monstuff.com/" title="Home" />
<link rel="prev" href="http://blog.monstuff.com/archives/000067.html" title="VS.net debugging tips whitepaper link" />

<link rel="next" href="http://blog.monstuff.com/archives/000071.html" title="The path to war" />



<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-74363-1";
urchinTracker();
</script>

<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'blog.monstuff.com';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>



<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="http://blog.monstuff.com/archives/000070.html">
<dc:title>Minimalistic C# media player</dc:title>
<dc:description>A while back (time flies), I wrote a little media player in C#. Its main characteristic is that it is window-less. All interactions are done using the media region and a circular context menu. The purpose of this experiment was to play with the MediaPlayer component and interop, and to try a UI-less interface design. Although all features are not yet implemented, I believe this prototype gives a good idea of the possibilities of this approach....</dc:description>
<dc:creator>Julien</dc:creator>
<dc:date>2003-06-28T11:48:14-08:00</dc:date>
<license rdf:resource="http://creativecommons.org/licenses/by-sa/1.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-sa/1.0/">
<requires rdf:resource="http://web.resource.org/cc/Attribution" />
<requires rdf:resource="http://web.resource.org/cc/Notice" />
<requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
<permits rdf:resource="http://web.resource.org/cc/Reproduction" />
<permits rdf:resource="http://web.resource.org/cc/Distribution" />
<permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
</License>
</rdf:RDF>
-->



</head>

<body>

<div id="banner">
<h1><a href="http://blog.monstuff.com/" accesskey="1">Curiosity is bliss</a></h1>
<span class="description">Julien Couvreur's programming blog and more</span>
</div>

<div id="container">

<div class="blog">







<div id="menu">
<a href="http://blog.monstuff.com/archives/000067.html">« VS.net debugging tips whitepaper link</a>&nbsp;&nbsp; 

| &nbsp;&nbsp;<a href="/archives.html">Archive list</a>&nbsp;&nbsp;
| &nbsp;&nbsp;<a href="http://blog.monstuff.com/archives/000380.html">Thick displays</a> (latest)

</div>

</div>

<div class="blog">

<!-- <h2 class="date">June 28, 2003</h2> -->




<div class="blogbody">
<!-- google_ad_section_start -->

<h2 class="title">Minimalistic C# media player</h2>

<p>A while back (time flies), I wrote a little media player in C#. Its main characteristic is that it is window-less. All interactions are done using the media region and a circular context menu.</p>

<p>The purpose of this experiment was to play with the MediaPlayer component and interop, and to try a UI-less interface design. Although all features are not yet implemented, I believe this prototype gives a good idea of the possibilities of this approach.</p>

<a name="more"></a>
<p><b>Interface manipulation</b><br />
The media rendering region can be manipulated by drag and dropping its nine areas. Dragging the center moves the "window" around, while clicking in the periphery resizes it. The cursor changes depending on its position to reflect this behavior.<br />
Using the whole surface of the "window" to manipulate makes it more efficient, as it is hard to target the edges of regular windows to resize them.</p>

<p>The context menu is a set of eight buttons that appear in circle around the cursor. Their labels change depending on the state of the player. Open, Close, Quit, Play, Pause are implemented, while the Maximize, Seek, Volume and Options menus are not yet functional.<br />
Using a context menu based interface gives quick mouse or stylus access to all the features while maximizing the available surface for the media rendering.</p>

<p><br />
<b>Future work</b><br />
Beside implementing the missing features like Volume, Seek and Maximize, having the cursor auto-hide would be a nice addition.</p>

<p>The current version also has two problems:<br />
- moving and resizing isn't always fluid and synchronized with the border of the window during the manipulation,<br />
- the window's resize speed is sometimes slower than the cursor's, which leads the cursor outside of the window and the window to not receive the mouse events anymore.</p>

<p>The first problem occurs both when the media is paused and playing. Windows Media Player 9 has a similar behavior (on my Windows 2000 box).</p>

<p>The second problem is rather tricky: as soon as the cursor goes out of the window (because the window is resizing too slowly) the window stops receiving mouse events and therefore the resizing is interrupted. I believe using a system-wide hook to intercept mouse events could be a solution, although rather complex. Regular windows don't have this problem because their resizing is handled by the windows manager itself.</p>

<p><br />
<b>Downloads</b><br />
Because the MediaPlayer renders using an overlay mechanism, I couldn't take a screenshot of the running app. So you'll have to try it for yourself.<br />
Here is a <a href="/archives/images/MiniMediaPlayer.zip">zip of the executable</a>, it also contains the two required interop dlls.<br />
The source is available <a href="http://cvs.monstuff.com/cgi-bin/cvsweb.cgi/MiniMediaPlayer/">here</a>.</p>

<span class="posted">Posted by Julien on June 28, 2003. <a href="http://blog.monstuff.com/archives/000070.html" rel="bookmark">Permalink</a> <!-- -->
<br /></span>

</div>



<div class="comments-head"><a name="comments"></a>Comments</div>

<div class="comments-body">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'curiosityisbliss'; 
        var disqus_identifier = '70';
        var disqus_url = 'http://blog.monstuff.com/archives/000070.html';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>    





<div class="comments-body">
<p>I have upgraded to the lastest version of Windows Media Player, and that appears to have broken the project.<br />
The binaries still work, but the AxMediaPlayer type isn't found anymore. The "Windows Media Player" component (added to the toolbox via "Cusomize Toolbox") now adds a AxWindowsMediaPlayer type instead :-(<br />
I'll try to fix when I have some time.</p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com/archives/000059.html">Dumky</a> at August  4, 2003 09:35 PM</span>
</div>
<div class="comments-body">
<p>hi<br />
 this is really cool. its nice to see a windows less media player. but i cant find the source if any body got it plz send it to me.</p>
<span class="comments-post">Posted by: <a href="mailto&#58;h_anandapadmanabhan&#64;rediffmail&#46;com">anand</a> at February  8, 2004 10:44 PM</span>
</div>
<div class="comments-body">
<p>I just sent you the files by email and updated the zip to contain the sources.<br />
My CVS is still down, because I don't have an internet connection at my new place yet. Sorry for the inconvenience.</p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com/">Dumky</a> at February  9, 2004 05:43 PM</span>
</div>
<div class="comments-body">
<p>I included the source in the zip file along with the binaries, since my CVS server is still down (I'm re-hosting).</p>

<p>Cheers<br />
Dumky</p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com">Dumky</a> at February 23, 2004 12:34 PM</span>
</div>
<div class="comments-body">
<p>hmmm .. nice project to build on ... was wondering if theres the MenuForm.resx .. seems to be missing from the zip.</p>

<p>thnx/Pete. </p>
<span class="comments-post">Posted by: <a href="http://www.w3coders.com">webmasta</a> at March  6, 2005 01:10 AM</span>
</div>
<div class="comments-body">
<p>Recreated a MenuForm.resx (by copying Form1.resx ;-) and adapted the code to the new WMP10 object model.</p>

<p>There is one outstanding bug, which seems to come from WMP10 handling events differently when a video is running or not: when a video is running and you right click, the context menu appears and disappears  instantly (instead of staying opened). Still trying to figure out a work-around.</p>

<p>A new zip is available at <a href="http://blog.monstuff.com/archives/images/MiniMediaPlayer.wmp10.src.zip">http://blog.monstuff.com/archives/images/MiniMediaPlayer.wmp10.src.zip</a></p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com/archives/images/MiniMediaPlayer.wmp10.src.zip">Julien Couvreur</a> at March  7, 2005 11:21 AM</span>
</div>
<div class="comments-body">
<p>I am looking for a simple videoplayer I can call from the cammandline and pass the video file name as a command line arguement and then quit the videoplayer when the clip has finished.</p>

<p>I have a video launcher application that works well with several video players using cammand line passing after the video completes the process ends.</p>

<p>I am trying to pass green screen cropped video onto the desktop using a window less video player and then making the background transparent with setlayerwindowsattributes. </p>

<p>I'd like to use your version because it allows the user to move the video around. </p>

<p>I also will eventually make the virtual people interactive.</p>

<p>any help is apprieciated.</p>

<p>Peter</p>
<span class="comments-post">Posted by: <a href="mailto&#58;zapphone&#64;aol&#46;com">Peter</a> at February  5, 2006 12:03 PM</span>
</div>



<div class="comments-head"><a name="trackbacks"></a>Trackbacks</div>



<!-- google_ad_section_end -->

<div class="comments-body">
<!--
Comments are closed. You can <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#106;&#117;&#108;&#105;&#101;&#110;&#46;&#99;&#111;&#117;&#118;&#114;&#101;&#117;&#114;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">contact me by email</a>. 
-->
</div>


</div>
</div>

<!-- google_ad_section_start(weight=ignore) -->
<div id="links">

<div class="sidetitle">
Recent Entries
</div>

<div class="side">
<a href="/archives.html">All entries (270)</a><br />
<br />

<a href="http://blog.monstuff.com/archives/000380.html">Thick displays</a><br />
<a href="http://blog.monstuff.com/archives/000377.html">Hans Rosling on the facts about population</a><br />
<a href="http://blog.monstuff.com/archives/000376.html">Bill Nye and Ken Ham debating on creationism</a><br />
<a href="http://blog.monstuff.com/archives/000375.html">Prediction vs Explanation</a><br />
<a href="http://blog.monstuff.com/archives/000374.html">Protectionism == Luddism</a><br />
<a href="http://blog.monstuff.com/archives/000373.html">Moderated off Boing Boing</a><br />
<a href="http://blog.monstuff.com/archives/000372.html">I &#9829; Patent Trolls</a><br />
<a href="http://blog.monstuff.com/archives/000371.html">Head Mounted Displays</a><br />
<a href="http://blog.monstuff.com/archives/000370.html">Better async programming in .Net</a><br />
<a href="http://blog.monstuff.com/archives/000369.html">Action, preferences, value</a><br />
<a href="http://blog.monstuff.com/archives/000368.html">Fresh breeze on climate debate</a><br />
<a href="http://blog.monstuff.com/archives/000367.html">On-the-fly book scanning</a><br />
<a href="http://blog.monstuff.com/archives/000366.html">State and education</a><br />
<a href="http://blog.monstuff.com/archives/000365.html">Live Geometry screencast</a><br />
<a href="http://blog.monstuff.com/archives/000364.html">Wired Science TV show</a><br />
<a href="http://blog.monstuff.com/archives/000362.html">Expectations and accountability in Economics</a><br />
<a href="http://blog.monstuff.com/archives/000361.html">Science of human action</a><br />
<a href="http://blog.monstuff.com/archives/000359.html">Reactive programming in javascript and C#</a><br />
<a href="http://blog.monstuff.com/archives/000358.html">Google Wave</a><br />
<a href="http://blog.monstuff.com/archives/000357.html">Reading facial expressions</a><br />

</div>
<!-- google_ad_section_end -->

</body>
</html>
