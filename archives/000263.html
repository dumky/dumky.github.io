<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>Curiosity is bliss: Javascript pen recognition</title>

<link rel="stylesheet" href="http://blog.monstuff.com/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.monstuff.com/index.rdf" />

<link rel="start" href="http://blog.monstuff.com/" title="Home" />
<link rel="prev" href="http://blog.monstuff.com/archives/000264.html" title="XmlHttpRequest - Add Latency" />

<link rel="next" href="http://blog.monstuff.com/archives/000265.html" title="New e-book devices announced (with e-ink)" />



<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-74363-1";
urchinTracker();
</script>

<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'blog.monstuff.com';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>



<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="http://blog.monstuff.com/archives/000263.html">
<dc:title>Javascript pen recognition</dc:title>
<dc:description><![CDATA[Here is a demonstration of a Graffiti-style block recognizer in javascript. It's based on the same algorithm as my previous C# implementation, and uses the firefox for the new &lt;canvas> element in Firefox 1.5 (codename DeerPark)....]]></dc:description>
<dc:creator>Julien</dc:creator>
<dc:date>2005-09-26T08:30:11-08:00</dc:date>
<license rdf:resource="http://creativecommons.org/licenses/by-sa/1.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-sa/1.0/">
<requires rdf:resource="http://web.resource.org/cc/Attribution" />
<requires rdf:resource="http://web.resource.org/cc/Notice" />
<requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
<permits rdf:resource="http://web.resource.org/cc/Reproduction" />
<permits rdf:resource="http://web.resource.org/cc/Distribution" />
<permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
</License>
</rdf:RDF>
-->



</head>

<body>

<div id="banner">
<h1><a href="http://blog.monstuff.com/" accesskey="1">Curiosity is bliss</a></h1>
<span class="description">Julien Couvreur's programming blog and more</span>
</div>

<div id="container">

<div class="blog">







<div id="menu">
<a href="http://blog.monstuff.com/archives/000264.html">« XmlHttpRequest - Add Latency</a>&nbsp;&nbsp; 

| &nbsp;&nbsp;<a href="/archives.html">Archive list</a>&nbsp;&nbsp;
| &nbsp;&nbsp;<a href="http://blog.monstuff.com/archives/000380.html">Thick displays</a> (latest)

</div>

</div>

<div class="blog">

<!-- <h2 class="date">September 26, 2005</h2> -->




<div class="blogbody">
<!-- google_ad_section_start -->

<h2 class="title">Javascript pen recognition</h2>

<p>Here is a demonstration of a <a href="http://blog.monstuff.com/archives/images/JS-graffiti.html">Graffiti-style block recognizer in javascript</a>. It's based on the same algorithm as my <a href="http://blog.monstuff.com/archives/000012.html">previous C# implementation</a>, and uses the firefox for the new &lt;canvas> element in Firefox 1.5 (codename DeerPark).</p>

<a name="more"></a>
<p> <br />
The canvas is one of the <a href="http://developer.mozilla.org/en/docs/Firefox_1.5_Beta_for_Developers">many new features in Firefox 1.5</a>. Its a screen area that can be painted programmatically. Apple first introduced it in Safari and the recent Firefox 1.5 (currently in beta) implements it as <a href="http://www.whatwg.org/specs/web-apps/current-work/#dynamic">specified (Web Applications 1.0 spec from the WHATWG group)</a>.</p>

<p><br />
<h4>Limitations:</h4>The graffiti recognition is not perfect, as I didn't implement some of the manual tuning/heuristics from my previous implementation. Moreover, the alphabet that I used isn't quite the official Graffiti one, but that could be fixed.<br />
Also, I was suprised at how much CPU is consumed by just tracking the mouse and drawing on the canvas; my 1GHz machine gets slown down even with this <a href="http://ponderer.org/canvas_demo">lightweight canvas demo</a>.</p>

<p><br />
<h4>Some further ideas:</h4>Firefox 1.5 has a subset of SVG built-in. It should be easy to write an interface based on SVG rather than the canvas. This would be nice for allowing to the post resulting "ink" back in an XML format.</p>

<p>The canvas element in general opens lots of possibilities for games and my graffiti script could be used for some too (sudoku, crosswords?). Besides that, I've been thinking about a canvas-based graphical interpreter such as <a href="http://en.wikipedia.org/wiki/Logo_programming_language">Logo</a> (great for teaching programming to kids and reminds me of some good old APPLE II days).</p>

<span class="posted">Posted by Julien on September 26, 2005. <a href="http://blog.monstuff.com/archives/000263.html" rel="bookmark">Permalink</a> <!-- -->
<br /></span>

</div>



<div class="comments-head"><a name="comments"></a>Comments</div>

<div class="comments-body">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'curiosityisbliss'; 
        var disqus_identifier = '263';
        var disqus_url = 'http://blog.monstuff.com/archives/000263.html';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>    





<div class="comments-body">
<p>Julien, great demo.</p>

<p>I've been thinking for a while about a mouse gesture lib. With all the drag-and-drop going on, i think it would be nice to be able to delete something by striking it out, for example. With canvas, you could easily show the strokes like the FF gestures extension. (I don't think there's a conflict with that extension as ajax mouse gestures would use left mouse button.)</p>

<p>BTW On the pen demo, any chance of swapping the alerts for a "pad" showing the history of letter guesses?</p>
<span class="comments-post">Posted by: <a href="http://ajaxpatterns.org">Michael Mahemoff</a> at September 29, 2005 11:37 AM</span>
</div>
<div class="comments-body">
<p>Hey Micheal,</p>

<p>What kind of gesture are you thinking for scratching? A single line (left to right or vice versa) or a more complex scratching gesture?<br />
The latter wouldn't work with my current implementation, as the number of back and forth would vary.</p>

<p>I removed the alert box. I actually had de-activated the "pad" code before putting it online ;-)</p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com">Julien</a> at September 29, 2005 12:23 PM</span>
</div>
<div class="comments-body">
<p>In the case of deletion, probably a single diagonal stroke is good enough provided it did the usual gesture-like things - "You appear to be using a mouse gesture for the first time. ..." - and a visual indication of what will happen before the button is actually released.</p>

<p>More generally though, I had in mind an engine like the FF extension, which transforms gestures into a sequence of numbers, so can easily be used generically. (I don't have the extension right now, I think it uses a number 1-8 for each possible direction.) You could then say:</p>

<p>portlet.onGesture = function(gesture) {<br />
  if (gesture.strokesMatch(1,8)) {<br />
     // User went left-up then right-down<br />
  }<br />
}</p>
<span class="comments-post">Posted by: <a href="http://ajaxpatterns.org">Michael Mahemoff</a> at September 29, 2005 03:11 PM</span>
</div>
<div class="comments-body">
<p>I have just converted this over to work with dojo (dojotoolkit.org) and this trick so that it works with IE too:<br />
<a href="http://me.eae.net/archive/2005/12/29/canvas-in-ie/">http://me.eae.net/archive/2005/12/29/canvas-in-ie/</a></p>

<p>Email me if you want any further details.</p>

<p>I haven't made it public though because you are using GPL.</p>

<p>Morris</p>
<span class="comments-post">Posted by: <a href="http://morrisjohns.com">Morris Johns</a> at February 14, 2006 05:44 AM</span>
</div>
<div class="comments-body">
<p>Morris,<br />
Nice work. I'd be happy to see it.<br />
GPL doesn't prevent you from making it public, on the contrary. What it means is that you have to provide the source of any modifications that you make. It basically "prevents" someone from taking from the community without giving back too.</p>

<p>Let me know when you post it.</p>
<span class="comments-post">Posted by: <a href="http://blog.monstuff.com">Julien Couvreur</a> at February 20, 2006 11:11 AM</span>
</div>



<div class="comments-head"><a name="trackbacks"></a>Trackbacks</div>

<div class="trackback-body">
<a name="399"></a>
<span class="trackback-post"><a href="http://www.phpmagazine.net/18_ajax/archive/1015_javascript_pen_recognition.html" target="new">Javascript pen recognition</a><br />
<b>Excerpt:</b> <p><a href="http://blog.monstuff.com/archives/000263.html">Julien Couvreur</a> have written a very nice javascript that allow <a href="http://blog.monstuff.com/archives/images/JS-graffiti.html">pen recognition</a> based on his previous </p><br />
<b>Weblog:</b> AJAX<br />
<b>Tracked:</b> September 26, 2005 10:44 AM</span>
</div>


<!-- google_ad_section_end -->

<div class="comments-body">
<!--
Comments are closed. You can <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#106;&#117;&#108;&#105;&#101;&#110;&#46;&#99;&#111;&#117;&#118;&#114;&#101;&#117;&#114;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">contact me by email</a>. 
-->
</div>


</div>
</div>

<!-- google_ad_section_start(weight=ignore) -->
<div id="links">

<div class="sidetitle">
Recent Entries
</div>

<div class="side">
<a href="/archives.html">All entries (270)</a><br />
<br />

<a href="http://blog.monstuff.com/archives/000380.html">Thick displays</a><br />
<a href="http://blog.monstuff.com/archives/000377.html">Hans Rosling on the facts about population</a><br />
<a href="http://blog.monstuff.com/archives/000376.html">Bill Nye and Ken Ham debating on creationism</a><br />
<a href="http://blog.monstuff.com/archives/000375.html">Prediction vs Explanation</a><br />
<a href="http://blog.monstuff.com/archives/000374.html">Protectionism == Luddism</a><br />
<a href="http://blog.monstuff.com/archives/000373.html">Moderated off Boing Boing</a><br />
<a href="http://blog.monstuff.com/archives/000372.html">I &#9829; Patent Trolls</a><br />
<a href="http://blog.monstuff.com/archives/000371.html">Head Mounted Displays</a><br />
<a href="http://blog.monstuff.com/archives/000370.html">Better async programming in .Net</a><br />
<a href="http://blog.monstuff.com/archives/000369.html">Action, preferences, value</a><br />
<a href="http://blog.monstuff.com/archives/000368.html">Fresh breeze on climate debate</a><br />
<a href="http://blog.monstuff.com/archives/000367.html">On-the-fly book scanning</a><br />
<a href="http://blog.monstuff.com/archives/000366.html">State and education</a><br />
<a href="http://blog.monstuff.com/archives/000365.html">Live Geometry screencast</a><br />
<a href="http://blog.monstuff.com/archives/000364.html">Wired Science TV show</a><br />
<a href="http://blog.monstuff.com/archives/000362.html">Expectations and accountability in Economics</a><br />
<a href="http://blog.monstuff.com/archives/000361.html">Science of human action</a><br />
<a href="http://blog.monstuff.com/archives/000359.html">Reactive programming in javascript and C#</a><br />
<a href="http://blog.monstuff.com/archives/000358.html">Google Wave</a><br />
<a href="http://blog.monstuff.com/archives/000357.html">Reading facial expressions</a><br />

</div>
<!-- google_ad_section_end -->

</body>
</html>
