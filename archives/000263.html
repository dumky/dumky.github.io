---
title: "Javascript pen recognition"
date: 2005-09-26 08:30:11 +0800
disqus_identifier: 263
disqus_url: http://blog.monstuff.com/archives/000263.html
---
{% raw %}
<p>Here is a demonstration of a <a href="http://blog.monstuff.com/archives/images/JS-graffiti.html">Graffiti-style block recognizer in javascript</a>. It's based on the same algorithm as my <a href="http://blog.monstuff.com/archives/000012.html">previous C# implementation</a>, and uses the firefox for the new &lt;canvas> element in Firefox 1.5 (codename DeerPark).</p>
<p> <br />
The canvas is one of the <a href="http://developer.mozilla.org/en/docs/Firefox_1.5_Beta_for_Developers">many new features in Firefox 1.5</a>. Its a screen area that can be painted programmatically. Apple first introduced it in Safari and the recent Firefox 1.5 (currently in beta) implements it as <a href="http://www.whatwg.org/specs/web-apps/current-work/#dynamic">specified (Web Applications 1.0 spec from the WHATWG group)</a>.</p>

<p><br />
<h4>Limitations:</h4>The graffiti recognition is not perfect, as I didn't implement some of the manual tuning/heuristics from my previous implementation. Moreover, the alphabet that I used isn't quite the official Graffiti one, but that could be fixed.<br />
Also, I was suprised at how much CPU is consumed by just tracking the mouse and drawing on the canvas; my 1GHz machine gets slown down even with this <a href="http://ponderer.org/canvas_demo">lightweight canvas demo</a>.</p>

<p><br />
<h4>Some further ideas:</h4>Firefox 1.5 has a subset of SVG built-in. It should be easy to write an interface based on SVG rather than the canvas. This would be nice for allowing to the post resulting "ink" back in an XML format.</p>

<p>The canvas element in general opens lots of possibilities for games and my graffiti script could be used for some too (sudoku, crosswords?). Besides that, I've been thinking about a canvas-based graphical interpreter such as <a href="http://en.wikipedia.org/wiki/Logo_programming_language">Logo</a> (great for teaching programming to kids and reminds me of some good old APPLE II days).</p>

______________________________________

<p>Julien, great demo.</p>

<p>I've been thinking for a while about a mouse gesture lib. With all the drag-and-drop going on, i think it would be nice to be able to delete something by striking it out, for example. With canvas, you could easily show the strokes like the FF gestures extension. (I don't think there's a conflict with that extension as ajax mouse gestures would use left mouse button.)</p>

<p>BTW On the pen demo, any chance of swapping the alerts for a "pad" showing the history of letter guesses?</p>

Posted by: <a href="http://ajaxpatterns.org">Michael Mahemoff</a> (September 29, 2005 11:37 AM)

______________________________________

<p>Hey Micheal,</p>

<p>What kind of gesture are you thinking for scratching? A single line (left to right or vice versa) or a more complex scratching gesture?<br />
The latter wouldn't work with my current implementation, as the number of back and forth would vary.</p>

<p>I removed the alert box. I actually had de-activated the "pad" code before putting it online ;-)</p>

Posted by: <a href="http://blog.monstuff.com">Julien</a> (September 29, 2005 12:23 PM)

______________________________________

<p>In the case of deletion, probably a single diagonal stroke is good enough provided it did the usual gesture-like things - "You appear to be using a mouse gesture for the first time. ..." - and a visual indication of what will happen before the button is actually released.</p>

<p>More generally though, I had in mind an engine like the FF extension, which transforms gestures into a sequence of numbers, so can easily be used generically. (I don't have the extension right now, I think it uses a number 1-8 for each possible direction.) You could then say:</p>

<p>portlet.onGesture = function(gesture) {<br />
  if (gesture.strokesMatch(1,8)) {<br />
     // User went left-up then right-down<br />
  }<br />
}</p>

Posted by: <a href="http://ajaxpatterns.org">Michael Mahemoff</a> (September 29, 2005 03:11 PM)

______________________________________

<p>I have just converted this over to work with dojo (dojotoolkit.org) and this trick so that it works with IE too:<br />
<a href="http://me.eae.net/archive/2005/12/29/canvas-in-ie/">http://me.eae.net/archive/2005/12/29/canvas-in-ie/</a></p>

<p>Email me if you want any further details.</p>

<p>I haven't made it public though because you are using GPL.</p>

<p>Morris</p>

Posted by: <a href="http://morrisjohns.com">Morris Johns</a> (February 14, 2006 05:44 AM)

______________________________________

<p>Morris,<br />
Nice work. I'd be happy to see it.<br />
GPL doesn't prevent you from making it public, on the contrary. What it means is that you have to provide the source of any modifications that you make. It basically "prevents" someone from taking from the community without giving back too.</p>

<p>Let me know when you post it.</p>

Posted by: <a href="http://blog.monstuff.com">Julien Couvreur</a> (February 20, 2006 11:11 AM)



{% endraw %}